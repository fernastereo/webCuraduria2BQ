<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.css">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../css/style.css?v=5">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link rel="stylesheet" href="../css/custom.css">
    <title>Curaduria BAQ - Resoluciones</title>
</head>
<body style="
min-height: 100vh; 
margin: 0;
display: grid;
grid-template-rows: auto 1fr auto;">
    <div id="nav-placeholder"></div>
    <section id="resoluciones" class="my-auto">
        <p class="text-center title-text mb-5 mt-5">Resoluciones expedidas</p>
        <div class="container mb-5">
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-2 row-cols-lg-2 m-0">
                <div class="col px-lg-0 px-sm-0 px-md-0 ps-0 mb-lg-3 mb-sm-3 mb-md-3 mb-0">
                    <div class="row row-cols-2 row-cols-sm-1 row-cols-md-1 row-cols-lg-1 m-0">
                        <div class="col px-lg-0 px-sm-0 px-md-0 ps-0 mb-lg-0 mb-sm-0 mb-md-0 mb-0">
                            <label for="numero" class="form-label">Numero</label>
                            <input type="number" name="numero" min="0" class="mb-lg-0 mb-sm-0 mb-md-0 mb-3" id="numero">
                            <label for="anio" class="form-label">Año</label>
                            <input type="text" name="anio" class="mb-lg-0 mb-sm-0 mb-md-0 mb-3" id="anio">
                        </div>
                    </div>
                </div>
                <div class="col px-lg-0 px-sm-0 px-md-0 ps-0 mb-lg-0 mb-sm-0 mb-md-0 mb-0">
                    <button class="btn btn-menu float-lg-end float-sm-end float-md-end" onclick="setRefresh()"> Consultar </button>
                </div>
            </div>
            <table id="table" data-toggle="table" data-show-toggle="true" data-pagination="false" >
                <thead>
                    <tr>
                        <th class="text-capitalize text-center">Radicacion</th>
                        <th class="text-capitalize text-center">Solicitante</th>
                        <th class="text-capitalize text-center">Direccion</th>
                        <th class="text-capitalize text-center">Modalidad</th>
                        <th class="text-capitalize text-center">Fecha De Resolucion</th>
                        <th class="text-capitalize text-center">Resolucion</th>
                        <th class="text-capitalize text-center">Ver</th>
                    </tr>
                </thead>
            </table>
        </div>
    </section>
    <footer class="pt-5 border-footer">
            <div id="exampleSlider" class="w-100">
                <div class="MS-content">
                    <div class="item">
                        <a href="https://idm.presidencia.gov.co/presidencia" target="_blank">
                            <img src="../img/Rectangle 3.png" alt="Presidencia" class="img-fluid">
                        </a>
                    </div>
                    <div class="item">
                        <a href="https://www.barranquilla.gov.co/" target="_blank">
                            <img src="../img/Rectangle 4.png" alt="Alcadía" class="img-fluid"> 
                        </a>
                    </div>
                    <div class="item">
                        <a href="https://www.minvivienda.gov.co/" target="_blank">
                            <img src="../img/Rectangle 5.png" alt="Minvivienda" class="img-fluid"> 
                        </a>
                    </div>
                    <div class="item">
                        <a href="https://www.mincultura.gov.co/Paginas/default.aspx" target="_blank">
                            <img src="../img/Rectangle 6.png" alt="Mincultura" class="img-fluid"> 
                        </a>
                    </div>
                    <div class="item">
                        <a href="https://www.minambiente.gov.co/" target="_blank">
                            <img src="../img/Rectangle 7.png" alt="Minambiente" class="img-fluid"> 
                        </a>
                    </div>
                    <div class="item">
                        <a href="https://www.gov.co/" target="_blank">
                            <img src="../img/Rectangle 8.png" alt="Gobierno" class="img-fluid"> 
                        </a>
                    </div>
                </div>
            </div>
        <div style="border: 1px solid #E5E5E5" class="mx-5"></div>
        <div class="text-center pt-4 pb-1 text-copyright">
            Horario: Lunes a viernes de 8:00 a.m. a 12:00p.m. y de 1:00p.m. a 5:00 p.m.
        </div>
        <div class="text-center pb-1 text-copyright">
            Teléfonos: 605 3566182 - 605 3565033 - 605 3201916 - 605 3428374 - 605 3049880 <br> Celular: 3166258944
        </div>
        <div class="text-center pb-1 text-copyright">
            Carrera 58 # 68 – 32 / <a href="mailto:info@curaduria2barranquilla.com" class="text-copyright text-decoration-none">info@curaduria2barranquilla.com</a>
        </div>
        <div class="text-center pb-4 text-copyright">
            2021 © Copyright. Curaduria Urbana No. 2 de Barraquilla
        </div>
    </footer>

    <!-- modal error send for request -->
    <div class="modal" id="message" tabindex="-1" aria-labelledby="message" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Error</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6 id="response"></h6>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-menu" data-bs-dismiss="modal">Close</button>
            </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.19.1/src/locale/bootstrap-table-es-MX.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js"></script>
    <script src="../js/multislider.min.js"></script>
    <script>
        function setRefresh() {
            var table = $('#table');
            table.bootstrapTable('refreshOptions',{
                ajax: getData,
                columns: [{
                    title: 'Radicacion',
                    field: 'radicacion',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    title: 'Solicitante',
                    field: 'solicitante',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    title: 'Direccion',
                    field: 'direccion',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    title: 'Modalidad',
                    field: 'modalidad',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    title: 'Fecha De Resolucion',
                    field: 'fecharesol',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    title: 'Resolucion',
                    field: 'resolucion',
                    sortable: true,
                    cellStyle: tableText,
                    align: 'center'
                }, {
                    field: 'file',
                    align: 'center',
                    event: window.operateEvents,           
                    clickToSelect: false,
                    formatter: operateFormatter
                }]
            });

            function tableText(value,row,index) {
                return {
                    classes: 'table-text'
                }
            }

            function operateFormatter(value, row, index) {
                return [
                '<a class="file" href="'+row.archivo+'" target="_blank" title="File">',
                    '<i class="fas fa-eye iconColor"></i>',
                '</a>  ',
                ].join('')
            }
        }
        
        function getData(params) {
            var toggleCard = document.getElementsByName("toggle");
            toggleCard[0].style.display = "none";
            var numero = $('#numero').val();
            var anio = $('#anio').val();
            var url = 'http://css-sas.com/apicuradurias/api/router.php/resolucion/2bq/'+numero+'/'+anio;
            console.log(url);
            $.get(url).then(function (res) {
                if (res.data) {
                    params.success(res.data);
                } else {
                    console.log(res);
                    $('#response').text(res.message);
                    $('#message').modal('show');
                    params.success([]);
                }
            });
        }
    </script>
    <script>
        $(function(){
            $('#nav-placeholder').load('../components/nav_pages.html');
            $("#anio").datepicker( {
                format: "yyyy", // Notice the Extra space at the beginning
                viewMode: "years", 
                minViewMode: "years",
                endDate : new Date()
            });
            var table = $('#table');
            if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {    
                var toggleCard = document.getElementsByName("toggle");
                toggleCard[0].click();
                toggleCard[0].style.display = "none";
            } else {
                var toggleCard = document.getElementsByName("toggle");
                toggleCard[0].style.display = "none";
            }
        });
        $(window).on('resize', function() {
            var win = $(this);
            if (win.width() < 1210 && win.width() > 993) {
                $('#menu_licencia').addClass('col');
                $('#menu_licencia').removeClass('col-auto');
            } else {
                $('#menu_licencia').removeClass('col');
                $('#menu_licencia').addClass('col-auto');
            }
        });
    </script>
    <script>
        $('#exampleSlider').multislider({
            continuous: true,
            hoverPause: false,
            duration: 3000
        });
    </script>
</body>
</html>